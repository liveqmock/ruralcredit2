<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="PAYMENTRECORD" >
   <typeAlias alias="paymentRecord" type="com.creditease.rc.domain.PaymentRecord"/>
   <typeAlias alias="creditApplication" type="com.creditease.rc.domain.CreditApplication" />
   <resultMap id="paymentRecordResultMap" class="com.creditease.rc.domain.PaymentRecord" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
    -->
    <result column="PAYMENT_RECORD_ID" property="paymentRecordId" jdbcType="DECIMAL" />
    <result column="CREDITAPPLICATION_ID" property="creditapplicationId" jdbcType="DECIMAL" />
    <result column="PAY_AMOUNT" property="payAmount" jdbcType="DECIMAL" />
    <result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
    <result column="OPERATOR_ID" property="operatorId" jdbcType="VARCHAR" />
    <result column="OPERATOR_NAME" property="operatorName" jdbcType="VARCHAR" />
    <result column="OPERATE_DATE" property="operateDate" jdbcType="TIMESTAMP" />
    <result column="REMARK" property="remark" jdbcType="VARCHAR" />
    <result column="HISTORY_FLAG" property="historyFlag" jdbcType="VARCHAR" />
  </resultMap>
  <select id="selectPaymentRecord" resultMap="paymentRecordResultMap" parameterClass="paymentRecord" >
   select * from RL_PAYMENT_RECORD where PAYMENT_RECORD_ID=( select max(PAYMENT_RECORD_ID)
    from RL_PAYMENT_RECORD
    where 1=1
    <isNotEmpty property="paymentRecordId" prepend="and">
    	PAYMENT_RECORD_ID = #paymentRecordId:DECIMAL#
    </isNotEmpty>
    <isNotEmpty property="creditapplicationId" prepend="and">
    	CREDITAPPLICATION_ID=#creditapplicationId#
    </isNotEmpty>
    <isNotEmpty property="historyFlag" prepend="and">
    	HISTORY_FLAG=#historyFlag#
    </isNotEmpty>
    )  
  </select>
  <select id="selectPaymentRecordByList" resultClass="creditApplication" parameterClass="List" >
	   SELECT P.CREDITAPPLICATION_ID creditapplicationId FROM RL_PAYMENT_RECORD P WHERE PAYMENT_RECORD_ID IN
	    <iterate open="(" close=")" conjunction=",">
				#integerVector[]#
		</iterate>
  </select>
  <insert id="insertPaymentRecord" parameterClass="paymentRecord" >
   <selectKey keyProperty="paymentRecordId" resultClass="int"
			type="pre">
			select SEQ_BASIC_INFO.NEXTVAL as value from dual
	</selectKey>
    insert into RL_PAYMENT_RECORD (PAYMENT_RECORD_ID, CREDITAPPLICATION_ID, PAY_AMOUNT, PAY_STATUS,
      OPERATOR_ID, OPERATOR_NAME, OPERATE_DATE, REMARK, HISTORY_FLAG)
    values (#paymentRecordId:DECIMAL#, #creditapplicationId:DECIMAL#, #payAmount:DECIMAL#,
      #payStatus:VARCHAR#, #operatorId:VARCHAR#, #operatorName:VARCHAR#, #operateDate:TIMESTAMP#,
      #remark:VARCHAR#, #historyFlag:VARCHAR#)
  </insert>
  <update id="updatePaymentRecord" parameterClass="paymentRecord" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
    -->
    update RL_PAYMENT_RECORD
    <dynamic prepend="set" >
      <isNotEmpty prepend="," property="historyFlag" >
        HISTORY_FLAG = #historyFlag:VARCHAR#
      </isNotEmpty>
    </dynamic>
    where PAYMENT_RECORD_ID = #paymentRecordId:DECIMAL#
  </update>
</sqlMap>